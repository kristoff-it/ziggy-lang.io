<!DOCTYPE html>
<html>
	<head id="head">
		<meta charset="UTF-8">
		<meta name="color-scheme" content="light dark">
		<meta name="description" content="Ziggy: A JSON/YAML/TOML alternative.">
		<meta name="twitter:card" content="summary">
		<meta name="twitter:site" content="@croloris">
		<meta name="twitter:author" content="@croloris">
		<meta name="twitter:description" content="Ziggy: A JSON/YAML/TOML alternative.">
		<meta name="twitter:title" content="Tagged Unions - Ziggy">
		<meta property="og:title" content="Tagged Unions">
		<meta property="og:type" content="website">
		<meta http-equiv="x-ua-compatible" content="ie=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<title id="title">
			Tagged Unions
			- Ziggy Data Language
		</title>
		<link rel="stylesheet" type="text/css" href="/fonts.css">
		<link rel="stylesheet" type="text/css" href="/style.css">
		<link rel="stylesheet" type="text/css" href="/highlight.css">
		
	<style>
		#content {
			display: flex;
			flex-direction: row;
			gap: 20px;
		}
		
		#sidebar {
			flex: 0 0 260px;
			padding-top: 0.67em;
		}
		
		#sidebar details {
			list-style: none;
		}
		
		#sidebar summary {
			border-top: 1px solid var(--border-color);
			list-style: none;
			padding: 10px 0;
			color: #333;
			font-weight: bold;
			padding-left: 10px;
		}
		
		#sidebar summary:hover {
			color: #111;
			background-color: #eee;
		}
		
		#sidebar ul {
			list-style: none;
			padding: 0;
			margin: 0 0 10px;
		}
		
		#sidebar a {
			display: block;
			text-decoration: none;
			padding: 5px 0;
			color: inherit;
			padding-left: 10px;
		}
		
		#sidebar a:hover, #sidebar .selected {
			background-color: #ddd;
		}
		
		#sidebar-content {
			position: sticky;
			top: 110px;
		}
		
		#footer {
			display: flex;
			flex-direction: row;
			justify-content: space-between;
			width: 100%;
			margin-top: 50px;
			border-top: 1px solid var(--border-color);
			text-align: right;
		}
		
		#footer a {
			text-decoration: none;
			color: inherit;
		}
		
		#footer .title {
			font-weight: bold;
			color: #222;
			text-decoration: underline;
		}
		
		#main {
			max-width: 920px;
			flex-grow: 1;
		}
		
		#main h2 {
			margin-top: 1.5em;
			border-bottom: 2px dotted #aaa;
		}
		
		pre {
			margin: 10px;
			padding: 0;
			border: 1px dashed;
			border-radius: 0;
		}
		
		pre code {
			display: block;
			padding: 30px;
			padding-top: 0;
			padding-right: 0;
		}
		
		p code {
			background-color: #333;
			border-radius: 4px;
			color: white;
			padding: 0.2em;
		}
		
		pre::before {
			display: block;
			content: "Shell";
			background-color: #fff;
			font-family: "Epilogue", sans-serif;
			font-size: 0.7em;
			color: #555;
			padding: 10px;
			padding-left: 15px;
			padding-top: 12px;
			text-transform: uppercase;
			margin-bottom: 30px;
			position: sticky;
			top: 0;
			left: 0;
			z-index: 10;
		}
		
		pre:has(> code.markdown):before {
			content: "Markdown";
		}
		
		pre:has(> code.javascript):before {
			content: "JavaScript";
		}
		
		pre:has(> code.zig):before {
			content: "Zig";
		}
		
		pre:has(> code.lua):before {
			content: "Lua";
		}
		
		pre:has(> code.toml):before {
			content: "TOML";
		}
		
		pre:has(> code.json):before {
			content: "JSON";
		}
		
		pre:has(> code.ziggy):before {
			content: "Ziggy Document";
		}
		
		pre:has(> code.ziggy-schema):before {
			content: "Ziggy Schema";
		}
		
		@media (prefers-color-scheme: dark) {
			#sidebar summary {
				border-color: var(--border-color);
				color: #eee;
			}
			
			#sidebar summary:hover {
				color: var(--text-color);
				background-color: #ffffff11;
			}
			
			#sidebar a:hover, #sidebar .selected {
				background-color: #ffffff33;
			}
			
			#footer .title {
				color: var(--text-color);
			}
			
			#main h2 {
				border-color: #aaa;
			}
			pre::before {
				background-color: #ffffff22;
				color: var(--text-color);
			}
		}
		
		@media (max-width: 1000px) {
			#content {
				padding: 0 15px;
				flex-direction: column-reverse;
			}
			
			#main {
				max-width: 1000px;
			}
			
		}
		
		#insanity {
			max-height: 400px;
			overflow-y: scroll;
		}
	</style>

	</head>
	<body id="body">
		<nav id="top-nav">
			<div id="top-nav-container">
				<span>
					<a href="/"
					   style="font-size: 1.8em;font-family:'Glue Gun';font-weight:bold;text-decoration: none; color: light-dark(black, white);"
					>Ziggy</a>
					<span>v0.0.1</span>
				</span>
				<div id="top-nav-menu">
					<a href="/documentation/getting-started/">
						Quickstart
					</a>
					<a href="/documentation/about/">
						Documentation
					</a>
					<a href="/log/">
						Changelog
					</a>
					<a href="https://github.com/kristoff-it/ziggy" target="_blank">
						Code
					</a>
				</div>
			</div>
		</nav>
		
	<div id="content">
		<nav id="sidebar">
			<div id="sidebar-content">
				<details open>
					<summary>Overview</summary>
					<ul>
						<li>
							<a class="" href="/documentation/about/">About</a>
						</li>
					
						<li>
							<a class="" href="/documentation/getting-started/">Getting Started</a>
						</li>
					</ul>
				</details>
				<details open>
					<summary>Editor Configuration</summary>
					<ul>
						<li>
							<a class="" href="/documentation/editors/vscode/">VSCode</a>
						</li>
					
						<li>
							<a class="" href="/documentation/editors/neovim/">Neovim</a>
						</li>
					
						<li>
							<a class="" href="/documentation/editors/helix/">Helix</a>
						</li>
					
						<li>
							<a class="" href="/documentation/editors/flow/">Flow</a>
						</li>
					
						<li>
							<a class="" href="/documentation/editors/emacs/">Emacs</a>
						</li>
					</ul>
				</details>
				<details open>
					<summary>Ziggy Document</summary>
					<ul>
						<li>
							<a class="" href="/documentation/scalars/">Scalar Values</a>
						</li>
					
						<li>
							<a class="" href="/documentation/containers/">Container Values</a>
						</li>
					
						<li>
							<a class="" href="/documentation/document/">Document Structure</a>
						</li>
					</ul>
				</details>
				<details open>
					<summary>Ziggy Schema</summary>
					<ul>
						<li>
							<a class="" href="/documentation/builtin-types/">Builtin Types</a>
						</li>
					
						<li>
							<a class="" href="/documentation/custom-types/">Custom Types</a>
						</li>
					
						<li>
							<a class="" href="/documentation/schema-structure/">Schema Structure</a>
						</li>
					</ul>
				</details>
				<details open>
					<summary>Design Tips</summary>
					<ul>
						<li>
							<a class="selected" href="/documentation/unions/">Tagged Unions</a>
						</li>
					</ul>
				</details>
				<details open>
					<summary>Libraries</summary>
					<ul>
						<li><a href="/documentation/parsers/">Parsers</a></li>
					</ul>
				</details>
				<details open>
					<summary>Using Ziggy from Zig</summary>
					<ul>
						<li>
							<a class="" href="/documentation/getting-started-dev/">Getting Started</a>
						</li>
					
						<li>
							<a class="" href="/documentation/parser-example/">Parser Example</a>
						</li>
					
						<li>
							<a class="" href="/documentation/frontmatter/">Frontmatter</a>
						</li>
					
						<li>
							<a class="" href="/documentation/serialization-example/">Serialization Example</a>
						</li>
					
						<li>
							<a class="" href="/documentation/metaprogramming/">Metaprogramming</a>
						</li>
					</ul>
				</details>
				<details open>
					<summary>Ziggy CLI Tool</summary>
					<ul>
						<li>
							<a class="" href="/documentation/ziggy-fmt/">ziggy fmt</a>
						</li>
					
						<li>
							<a class="" href="/documentation/ziggy-query/">ziggy query</a>
						</li>
					
						<li>
							<a class="" href="/documentation/ziggy-check/">ziggy check</a>
						</li>
					
						<li>
							<a class="" href="/documentation/ziggy-convert/">ziggy convert</a>
						</li>
					
						<li>
							<a class="" href="/documentation/ziggy-lsp/">ziggy lsp</a>
						</li>
					</ul>
				</details>
				<details>
					<summary>Specification</summary>
					<ul>
						<li>
							<a class="" href="/documentation/spec/">Specification</a>
						</li>
					</ul>
				</details>
			</div>
		</nav>
		<div id="main">
			<div><h1>Understanding Tagged Unions</h1><h2>Introduction</h2><p>Tagged unions are possibly the best feature of Ziggy as they define a simple yet powerful sweetspot between simplicity and expressiveness of the schema language.</p><p>While on one hand we could make the schema language more powerful and give it ways of specifying more nuanced constraints, on the other we could be making it so complex that people would end up not using it as much because it becomes too tedious to write a schema.</p><p>For comparison, see this excerpt from a <a href="https://json-schema.org/" target="_blank">JSON Schema</a>, where the extreme flexibility of the language causes some schemas to devolve into pure insanity.</p><p><pre id="insanity"><code class="json"><span class="string">&quot;project&quot;</span>: {
  <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,
  <span class="string_special_key string">&quot;properties&quot;</span>: {
    <span class="string_special_key string">&quot;cli&quot;</span>: {
      <span class="string_special_key string">&quot;schematicCollections&quot;</span>: {
        <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;array&quot;</span>,
        <span class="string_special_key string">&quot;description&quot;</span>: <span class="string">&quot;The list of schematic collections to use.&quot;</span>,
        <span class="string_special_key string">&quot;items&quot;</span>: {
          <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,
          <span class="string_special_key string">&quot;uniqueItems&quot;</span>: <span class="constant_builtin">true</span>
        }
      }
    },
    <span class="string_special_key string">&quot;schematics&quot;</span>: {
      <span class="string_special_key string">&quot;$ref&quot;</span>: <span class="string">&quot;#/definitions/schematicOptions&quot;</span>
    },
    <span class="string_special_key string">&quot;prefix&quot;</span>: {
      <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,
      <span class="string_special_key string">&quot;format&quot;</span>: <span class="string">&quot;html-selector&quot;</span>,
      <span class="string_special_key string">&quot;description&quot;</span>: <span class="string">&quot;The prefix to apply to generated selectors.&quot;</span>
    },
    <span class="string_special_key string">&quot;root&quot;</span>: {
      <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,
      <span class="string_special_key string">&quot;description&quot;</span>: <span class="string">&quot;Root of the project files.&quot;</span>
    },
    <span class="string_special_key string">&quot;i18n&quot;</span>: {
      <span class="string_special_key string">&quot;$ref&quot;</span>: <span class="string">&quot;#/definitions/project/definitions/i18n&quot;</span>
    },
    <span class="string_special_key string">&quot;sourceRoot&quot;</span>: {
      <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,
      <span class="string_special_key string">&quot;description&quot;</span>: <span class="string">&quot;The root of the source files, assets and index.html file structure.&quot;</span>
    },
    <span class="string_special_key string">&quot;projectType&quot;</span>: {
      <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,
      <span class="string_special_key string">&quot;description&quot;</span>: <span class="string">&quot;Project type.&quot;</span>,
      <span class="string_special_key string">&quot;enum&quot;</span>: [
        <span class="string">&quot;application&quot;</span>,
        <span class="string">&quot;library&quot;</span>
      ]
    },
    <span class="string_special_key string">&quot;architect&quot;</span>: {
      <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,
      <span class="string_special_key string">&quot;additionalProperties&quot;</span>: {
        <span class="string_special_key string">&quot;$ref&quot;</span>: <span class="string">&quot;#/definitions/project/definitions/target&quot;</span>
      }
    },
    <span class="string_special_key string">&quot;targets&quot;</span>: {
      <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,
      <span class="string_special_key string">&quot;additionalProperties&quot;</span>: {
        <span class="string_special_key string">&quot;$ref&quot;</span>: <span class="string">&quot;#/definitions/project/definitions/target&quot;</span>
      }
    }
  },
  <span class="string_special_key string">&quot;required&quot;</span>: [
    <span class="string">&quot;root&quot;</span>,
    <span class="string">&quot;projectType&quot;</span>
  ],
  <span class="string_special_key string">&quot;anyOf&quot;</span>: [
    {
      <span class="string_special_key string">&quot;required&quot;</span>: [
        <span class="string">&quot;architect&quot;</span>
      ],
      <span class="string_special_key string">&quot;not&quot;</span>: {
        <span class="string_special_key string">&quot;required&quot;</span>: [
          <span class="string">&quot;targets&quot;</span>
        ]
      }
    },
    {
      <span class="string_special_key string">&quot;required&quot;</span>: [
        <span class="string">&quot;targets&quot;</span>
      ],
      <span class="string_special_key string">&quot;not&quot;</span>: {
        <span class="string_special_key string">&quot;required&quot;</span>: [
          <span class="string">&quot;architect&quot;</span>
        ]
      }
    },
    {
      <span class="string_special_key string">&quot;not&quot;</span>: {
        <span class="string_special_key string">&quot;required&quot;</span>: [
          <span class="string">&quot;targets&quot;</span>,
          <span class="string">&quot;architect&quot;</span>
        ]
      }
    }
  ],
  <span class="string_special_key string">&quot;additionalProperties&quot;</span>: <span class="constant_builtin">false</span>,
  <span class="string_special_key string">&quot;patternProperties&quot;</span>: {
    <span class="string_special_key string">&quot;^[a-z]{1,3}-.*&quot;</span>: {}
  },
  <span class="string_special_key string">&quot;definitions&quot;</span>: {
    <span class="string_special_key string">&quot;i18n&quot;</span>: {
      <span class="string_special_key string">&quot;description&quot;</span>: <span class="string">&quot;Project i18n options&quot;</span>,
      <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,
      <span class="string_special_key string">&quot;properties&quot;</span>: {
        <span class="string_special_key string">&quot;sourceLocale&quot;</span>: {
          <span class="string_special_key string">&quot;oneOf&quot;</span>: [
            {
              <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,
              <span class="string_special_key string">&quot;description&quot;</span>: <span class="string">&quot;Specifies the source locale of the application.&quot;</span>,
              <span class="string_special_key string">&quot;default&quot;</span>: <span class="string">&quot;en-US&quot;</span>,
              <span class="string_special_key string">&quot;$comment&quot;</span>: <span class="string">&quot;IETF BCP 47 language tag (simplified)&quot;</span>,
              <span class="string_special_key string">&quot;pattern&quot;</span>: <span class="string">&quot;^[a-zA-Z]{2,3}(-[a-zA-Z]{4})?(-([a-zA-Z]{2}|[0-9]{3}))?(-[a-zA-Z]{5,8})?(-x(-[a-zA-Z0-9]{1,8})+)?$&quot;</span>
            },
            {
              <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,
              <span class="string_special_key string">&quot;description&quot;</span>: <span class="string">&quot;Localization options to use for the source locale&quot;</span>,
              <span class="string_special_key string">&quot;properties&quot;</span>: {
                <span class="string_special_key string">&quot;code&quot;</span>: {
                  <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,
                  <span class="string_special_key string">&quot;description&quot;</span>: <span class="string">&quot;Specifies the locale code of the source locale&quot;</span>,
                  <span class="string_special_key string">&quot;pattern&quot;</span>: <span class="string">&quot;^[a-zA-Z]{2,3}(-[a-zA-Z]{4})?(-([a-zA-Z]{2}|[0-9]{3}))?(-[a-zA-Z]{5,8})?(-x(-[a-zA-Z0-9]{1,8})+)?$&quot;</span>
                },
                <span class="string_special_key string">&quot;baseHref&quot;</span>: {
                  <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,
                  <span class="string_special_key string">&quot;description&quot;</span>: <span class="string">&quot;HTML base HREF to use for the locale (defaults to the locale code)&quot;</span>
                }
              },
              <span class="string_special_key string">&quot;additionalProperties&quot;</span>: <span class="constant_builtin">false</span>
            }
          ]
        },
        <span class="string_special_key string">&quot;locales&quot;</span>: {
          <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,
          <span class="string_special_key string">&quot;additionalProperties&quot;</span>: <span class="constant_builtin">false</span>,
          <span class="string_special_key string">&quot;patternProperties&quot;</span>: {
            <span class="string_special_key string">&quot;^[a-zA-Z]{2,3}(-[a-zA-Z]{4})?(-([a-zA-Z]{2}|[0-9]{3}))?(-[a-zA-Z]{5,8})?(-x(-[a-zA-Z0-9]{1,8})+)?$&quot;</span>: {
              <span class="string_special_key string">&quot;oneOf&quot;</span>: [
                {
                  <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,
                  <span class="string_special_key string">&quot;description&quot;</span>: <span class="string">&quot;Localization file to use for i18n&quot;</span>
                },
                {
                  <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;array&quot;</span>,
                  <span class="string_special_key string">&quot;description&quot;</span>: <span class="string">&quot;Localization files to use for i18n&quot;</span>,
                  <span class="string_special_key string">&quot;items&quot;</span>: {
                    <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,
                    <span class="string_special_key string">&quot;uniqueItems&quot;</span>: <span class="constant_builtin">true</span>
                  }
                },
                {
                  <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,
                  <span class="string_special_key string">&quot;description&quot;</span>: <span class="string">&quot;Localization options to use for the locale&quot;</span>,
                  <span class="string_special_key string">&quot;properties&quot;</span>: {
                    <span class="string_special_key string">&quot;translation&quot;</span>: {
                      <span class="string_special_key string">&quot;oneOf&quot;</span>: [
                        {
                          <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,
                          <span class="string_special_key string">&quot;description&quot;</span>: <span class="string">&quot;Localization file to use for i18n&quot;</span>
                        },
                        {
                          <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;array&quot;</span>,
                          <span class="string_special_key string">&quot;description&quot;</span>: <span class="string">&quot;Localization files to use for i18n&quot;</span>,
                          <span class="string_special_key string">&quot;items&quot;</span>: {
                            <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,
                            <span class="string_special_key string">&quot;uniqueItems&quot;</span>: <span class="constant_builtin">true</span>
                          }
                        }
                      ]
                    },
                    <span class="string_special_key string">&quot;baseHref&quot;</span>: {
                      <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,
                      <span class="string_special_key string">&quot;description&quot;</span>: <span class="string">&quot;HTML base HREF to use for the locale (defaults to the locale code)&quot;</span>
                    }
                  },
                  <span class="string_special_key string">&quot;additionalProperties&quot;</span>: <span class="constant_builtin">false</span>
                }
              ]
            }
          }
        }
      },
      <span class="string_special_key string">&quot;additionalProperties&quot;</span>: <span class="constant_builtin">false</span>
    },
    <span class="string_special_key string">&quot;target&quot;</span>: {
      <span class="string_special_key string">&quot;oneOf&quot;</span>: [
        {
          <span class="string_special_key string">&quot;$comment&quot;</span>: <span class="string">&quot;Extendable target with custom builder&quot;</span>,
          <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,
          <span class="string_special_key string">&quot;properties&quot;</span>: {
            <span class="string_special_key string">&quot;builder&quot;</span>: {
              <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,
              <span class="string_special_key string">&quot;description&quot;</span>: <span class="string">&quot;The builder used for this package.&quot;</span>,
              <span class="string_special_key string">&quot;not&quot;</span>: {
                <span class="string_special_key string">&quot;enum&quot;</span>: [
                  <span class="string">&quot;@angular-devkit/build-angular:application&quot;</span>,
                  <span class="string">&quot;@angular-devkit/build-angular:app-shell&quot;</span>,
                  <span class="string">&quot;@angular-devkit/build-angular:browser&quot;</span>,
                  <span class="string">&quot;@angular-devkit/build-angular:browser-esbuild&quot;</span>,
                  <span class="string">&quot;@angular-devkit/build-angular:dev-server&quot;</span>,
                  <span class="string">&quot;@angular-devkit/build-angular:extract-i18n&quot;</span>,
                  <span class="string">&quot;@angular-devkit/build-angular:karma&quot;</span>,
                  <span class="string">&quot;@angular-devkit/build-angular:ng-packagr&quot;</span>,
                  <span class="string">&quot;@angular-devkit/build-angular:prerender&quot;</span>,
                  <span class="string">&quot;@angular-devkit/build-angular:jest&quot;</span>,
                  <span class="string">&quot;@angular-devkit/build-angular:web-test-runner&quot;</span>,
                  <span class="string">&quot;@angular-devkit/build-angular:protractor&quot;</span>,
                  <span class="string">&quot;@angular-devkit/build-angular:server&quot;</span>,
                  <span class="string">&quot;@angular-devkit/build-angular:ssr-dev-server&quot;</span>
                ]
              }
            },
            <span class="string_special_key string">&quot;defaultConfiguration&quot;</span>: {
              <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,
              <span class="string_special_key string">&quot;description&quot;</span>: <span class="string">&quot;A default named configuration to use when a target configuration is not provided.&quot;</span>
            },
            <span class="string_special_key string">&quot;options&quot;</span>: {
              <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>
            },
            <span class="string_special_key string">&quot;configurations&quot;</span>: {
              <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,
              <span class="string_special_key string">&quot;description&quot;</span>: <span class="string">&quot;A map of alternative target options.&quot;</span>,
              <span class="string_special_key string">&quot;additionalProperties&quot;</span>: {
                <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>
              }
            }
          },
          <span class="string_special_key string">&quot;additionalProperties&quot;</span>: <span class="constant_builtin">false</span>,
          <span class="string_special_key string">&quot;required&quot;</span>: [
            <span class="string">&quot;builder&quot;</span>
          ]
        },
        {
          <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,
          <span class="string_special_key string">&quot;additionalProperties&quot;</span>: <span class="constant_builtin">false</span>,
          <span class="string_special_key string">&quot;properties&quot;</span>: {
            <span class="string_special_key string">&quot;builder&quot;</span>: {
              <span class="string_special_key string">&quot;const&quot;</span>: <span class="string">&quot;@angular-devkit/build-angular:application&quot;</span>
            },
            <span class="string_special_key string">&quot;defaultConfiguration&quot;</span>: {
              <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,
              <span class="string_special_key string">&quot;description&quot;</span>: <span class="string">&quot;A default named configuration to use when a target configuration is not provided.&quot;</span>
            },
            <span class="string_special_key string">&quot;options&quot;</span>: {
              <span class="string_special_key string">&quot;$ref&quot;</span>: <span class="string">&quot;../../../../angular_devkit/build_angular/src/builders/application/schema.json&quot;</span>
            },
            <span class="string_special_key string">&quot;configurations&quot;</span>: {
              <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,
              <span class="string_special_key string">&quot;additionalProperties&quot;</span>: {
                <span class="string_special_key string">&quot;$ref&quot;</span>: <span class="string">&quot;../../../../angular_devkit/build_angular/src/builders/application/schema.json&quot;</span>
              }
            }
          }
        },
        {
          <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,
          <span class="string_special_key string">&quot;additionalProperties&quot;</span>: <span class="constant_builtin">false</span>,
          <span class="string_special_key string">&quot;properties&quot;</span>: {
            <span class="string_special_key string">&quot;builder&quot;</span>: {
              <span class="string_special_key string">&quot;const&quot;</span>: <span class="string">&quot;@angular-devkit/build-angular:app-shell&quot;</span>
            },
            <span class="string_special_key string">&quot;defaultConfiguration&quot;</span>: {
              <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,
              <span class="string_special_key string">&quot;description&quot;</span>: <span class="string">&quot;A default named configuration to use when a target configuration is not provided.&quot;</span>
            },
            <span class="string_special_key string">&quot;options&quot;</span>: {
              <span class="string_special_key string">&quot;$ref&quot;</span>: <span class="string">&quot;../../../../angular_devkit/build_angular/src/builders/app-shell/schema.json&quot;</span>
            },
            <span class="string_special_key string">&quot;configurations&quot;</span>: {
              <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,
              <span class="string_special_key string">&quot;additionalProperties&quot;</span>: {
                <span class="string_special_key string">&quot;$ref&quot;</span>: <span class="string">&quot;../../../../angular_devkit/build_angular/src/builders/app-shell/schema.json&quot;</span>
              }
            }
          }
        },
        {
          <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,
          <span class="string_special_key string">&quot;additionalProperties&quot;</span>: <span class="constant_builtin">false</span>,
          <span class="string_special_key string">&quot;properties&quot;</span>: {
            <span class="string_special_key string">&quot;builder&quot;</span>: {
              <span class="string_special_key string">&quot;const&quot;</span>: <span class="string">&quot;@angular-devkit/build-angular:browser&quot;</span>
            },
            <span class="string_special_key string">&quot;defaultConfiguration&quot;</span>: {
              <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,
              <span class="string_special_key string">&quot;description&quot;</span>: <span class="string">&quot;A default named configuration to use when a target configuration is not provided.&quot;</span>
            },
            <span class="string_special_key string">&quot;options&quot;</span>: {
              <span class="string_special_key string">&quot;$ref&quot;</span>: <span class="string">&quot;../../../../angular_devkit/build_angular/src/builders/browser/schema.json&quot;</span>
            },
            <span class="string_special_key string">&quot;configurations&quot;</span>: {
              <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,
              <span class="string_special_key string">&quot;additionalProperties&quot;</span>: {
                <span class="string_special_key string">&quot;$ref&quot;</span>: <span class="string">&quot;../../../../angular_devkit/build_angular/src/builders/browser/schema.json&quot;</span>
              }
            }
          }
        },
        {
          <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,
          <span class="string_special_key string">&quot;additionalProperties&quot;</span>: <span class="constant_builtin">false</span>,
          <span class="string_special_key string">&quot;properties&quot;</span>: {
            <span class="string_special_key string">&quot;builder&quot;</span>: {
              <span class="string_special_key string">&quot;const&quot;</span>: <span class="string">&quot;@angular-devkit/build-angular:browser-esbuild&quot;</span>
            },
            <span class="string_special_key string">&quot;defaultConfiguration&quot;</span>: {
              <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,
              <span class="string_special_key string">&quot;description&quot;</span>: <span class="string">&quot;A default named configuration to use when a target configuration is not provided.&quot;</span>
            },
            <span class="string_special_key string">&quot;options&quot;</span>: {
              <span class="string_special_key string">&quot;$ref&quot;</span>: <span class="string">&quot;../../../../angular_devkit/build_angular/src/builders/browser-esbuild/schema.json&quot;</span>
            },
            <span class="string_special_key string">&quot;configurations&quot;</span>: {
              <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,
              <span class="string_special_key string">&quot;additionalProperties&quot;</span>: {
                <span class="string_special_key string">&quot;$ref&quot;</span>: <span class="string">&quot;../../../../angular_devkit/build_angular/src/builders/browser-esbuild/schema.json&quot;</span>
              }
            }
          }
        },
        {
          <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,
          <span class="string_special_key string">&quot;additionalProperties&quot;</span>: <span class="constant_builtin">false</span>,
          <span class="string_special_key string">&quot;properties&quot;</span>: {
            <span class="string_special_key string">&quot;builder&quot;</span>: {
              <span class="string_special_key string">&quot;const&quot;</span>: <span class="string">&quot;@angular-devkit/build-angular:dev-server&quot;</span>
            },
            <span class="string_special_key string">&quot;defaultConfiguration&quot;</span>: {
              <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,
              <span class="string_special_key string">&quot;description&quot;</span>: <span class="string">&quot;A default named configuration to use when a target configuration is not provided.&quot;</span>
            },
            <span class="string_special_key string">&quot;options&quot;</span>: {
              <span class="string_special_key string">&quot;$ref&quot;</span>: <span class="string">&quot;../../../../angular_devkit/build_angular/src/builders/dev-server/schema.json&quot;</span>
            },
            <span class="string_special_key string">&quot;configurations&quot;</span>: {
              <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,
              <span class="string_special_key string">&quot;additionalProperties&quot;</span>: {
                <span class="string_special_key string">&quot;$ref&quot;</span>: <span class="string">&quot;../../../../angular_devkit/build_angular/src/builders/dev-server/schema.json&quot;</span>
              }
            }
          }
        },
        {
          <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,
          <span class="string_special_key string">&quot;additionalProperties&quot;</span>: <span class="constant_builtin">false</span>,
          <span class="string_special_key string">&quot;properties&quot;</span>: {
            <span class="string_special_key string">&quot;builder&quot;</span>: {
              <span class="string_special_key string">&quot;const&quot;</span>: <span class="string">&quot;@angular-devkit/build-angular:extract-i18n&quot;</span>
            },
            <span class="string_special_key string">&quot;defaultConfiguration&quot;</span>: {
              <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,
              <span class="string_special_key string">&quot;description&quot;</span>: <span class="string">&quot;A default named configuration to use when a target configuration is not provided.&quot;</span>
            },
            <span class="string_special_key string">&quot;options&quot;</span>: {
              <span class="string_special_key string">&quot;$ref&quot;</span>: <span class="string">&quot;../../../../angular_devkit/build_angular/src/builders/extract-i18n/schema.json&quot;</span>
            },
            <span class="string_special_key string">&quot;configurations&quot;</span>: {
              <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,
              <span class="string_special_key string">&quot;additionalProperties&quot;</span>: {
                <span class="string_special_key string">&quot;$ref&quot;</span>: <span class="string">&quot;../../../../angular_devkit/build_angular/src/builders/extract-i18n/schema.json&quot;</span>
              }
            }
          }
        },
        {
          <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,
          <span class="string_special_key string">&quot;additionalProperties&quot;</span>: <span class="constant_builtin">false</span>,
          <span class="string_special_key string">&quot;properties&quot;</span>: {
            <span class="string_special_key string">&quot;builder&quot;</span>: {
              <span class="string_special_key string">&quot;const&quot;</span>: <span class="string">&quot;@angular-devkit/build-angular:karma&quot;</span>
            },
            <span class="string_special_key string">&quot;defaultConfiguration&quot;</span>: {
              <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,
              <span class="string_special_key string">&quot;description&quot;</span>: <span class="string">&quot;A default named configuration to use when a target configuration is not provided.&quot;</span>
            },
            <span class="string_special_key string">&quot;options&quot;</span>: {
              <span class="string_special_key string">&quot;$ref&quot;</span>: <span class="string">&quot;../../../../angular_devkit/build_angular/src/builders/karma/schema.json&quot;</span>
            },
            <span class="string_special_key string">&quot;configurations&quot;</span>: {
              <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,
              <span class="string_special_key string">&quot;additionalProperties&quot;</span>: {
                <span class="string_special_key string">&quot;$ref&quot;</span>: <span class="string">&quot;../../../../angular_devkit/build_angular/src/builders/karma/schema.json&quot;</span>
              }
            }
          }
        },
        {
          <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,
          <span class="string_special_key string">&quot;additionalProperties&quot;</span>: <span class="constant_builtin">false</span>,
          <span class="string_special_key string">&quot;properties&quot;</span>: {
            <span class="string_special_key string">&quot;builder&quot;</span>: {
              <span class="string_special_key string">&quot;const&quot;</span>: <span class="string">&quot;@angular-devkit/build-angular:jest&quot;</span>
            },
            <span class="string_special_key string">&quot;defaultConfiguration&quot;</span>: {
              <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,
              <span class="string_special_key string">&quot;description&quot;</span>: <span class="string">&quot;A default named configuration to use when a target configuration is not provided.&quot;</span>
            },
            <span class="string_special_key string">&quot;options&quot;</span>: {
              <span class="string_special_key string">&quot;$ref&quot;</span>: <span class="string">&quot;../../../../angular_devkit/build_angular/src/builders/jest/schema.json&quot;</span>
            },
            <span class="string_special_key string">&quot;configurations&quot;</span>: {
              <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,
              <span class="string_special_key string">&quot;additionalProperties&quot;</span>: {
                <span class="string_special_key string">&quot;$ref&quot;</span>: <span class="string">&quot;../../../../angular_devkit/build_angular/src/builders/jest/schema.json&quot;</span>
              }
            }
          }
        },
        {
          <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,
          <span class="string_special_key string">&quot;additionalProperties&quot;</span>: <span class="constant_builtin">false</span>,
          <span class="string_special_key string">&quot;properties&quot;</span>: {
            <span class="string_special_key string">&quot;builder&quot;</span>: {
              <span class="string_special_key string">&quot;const&quot;</span>: <span class="string">&quot;@angular-devkit/build-angular:web-test-runner&quot;</span>
            },
            <span class="string_special_key string">&quot;defaultConfiguration&quot;</span>: {
              <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,
              <span class="string_special_key string">&quot;description&quot;</span>: <span class="string">&quot;A default named configuration to use when a target configuration is not provided.&quot;</span>
            },
            <span class="string_special_key string">&quot;options&quot;</span>: {
              <span class="string_special_key string">&quot;$ref&quot;</span>: <span class="string">&quot;../../../../angular_devkit/build_angular/src/builders/web-test-runner/schema.json&quot;</span>
            },
            <span class="string_special_key string">&quot;configurations&quot;</span>: {
              <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,
              <span class="string_special_key string">&quot;additionalProperties&quot;</span>: {
                <span class="string_special_key string">&quot;$ref&quot;</span>: <span class="string">&quot;../../../../angular_devkit/build_angular/src/builders/web-test-runner/schema.json&quot;</span>
              }
            }
          }
        },
        {
          <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,
          <span class="string_special_key string">&quot;additionalProperties&quot;</span>: <span class="constant_builtin">false</span>,
          <span class="string_special_key string">&quot;properties&quot;</span>: {
            <span class="string_special_key string">&quot;builder&quot;</span>: {
              <span class="string_special_key string">&quot;const&quot;</span>: <span class="string">&quot;@angular-devkit/build-angular:protractor&quot;</span>
            },
            <span class="string_special_key string">&quot;defaultConfiguration&quot;</span>: {
              <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,
              <span class="string_special_key string">&quot;description&quot;</span>: <span class="string">&quot;A default named configuration to use when a target configuration is not provided.&quot;</span>
            },
            <span class="string_special_key string">&quot;options&quot;</span>: {
              <span class="string_special_key string">&quot;$ref&quot;</span>: <span class="string">&quot;../../../../angular_devkit/build_angular/src/builders/protractor/schema.json&quot;</span>
            },
            <span class="string_special_key string">&quot;configurations&quot;</span>: {
              <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,
              <span class="string_special_key string">&quot;additionalProperties&quot;</span>: {
                <span class="string_special_key string">&quot;$ref&quot;</span>: <span class="string">&quot;../../../../angular_devkit/build_angular/src/builders/protractor/schema.json&quot;</span>
              }
            }
          }
        },
        {
          <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,
          <span class="string_special_key string">&quot;additionalProperties&quot;</span>: <span class="constant_builtin">false</span>,
          <span class="string_special_key string">&quot;properties&quot;</span>: {
            <span class="string_special_key string">&quot;builder&quot;</span>: {
              <span class="string_special_key string">&quot;const&quot;</span>: <span class="string">&quot;@angular-devkit/build-angular:prerender&quot;</span>
            },
            <span class="string_special_key string">&quot;defaultConfiguration&quot;</span>: {
              <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,
              <span class="string_special_key string">&quot;description&quot;</span>: <span class="string">&quot;A default named configuration to use when a target configuration is not provided.&quot;</span>
            },
            <span class="string_special_key string">&quot;options&quot;</span>: {
              <span class="string_special_key string">&quot;$ref&quot;</span>: <span class="string">&quot;../../../../angular_devkit/build_angular/src/builders/prerender/schema.json&quot;</span>
            },
            <span class="string_special_key string">&quot;configurations&quot;</span>: {
              <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,
              <span class="string_special_key string">&quot;additionalProperties&quot;</span>: {
                <span class="string_special_key string">&quot;$ref&quot;</span>: <span class="string">&quot;../../../../angular_devkit/build_angular/src/builders/prerender/schema.json&quot;</span>
              }
            }
          }
        },
        {
          <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,
          <span class="string_special_key string">&quot;additionalProperties&quot;</span>: <span class="constant_builtin">false</span>,
          <span class="string_special_key string">&quot;properties&quot;</span>: {
            <span class="string_special_key string">&quot;builder&quot;</span>: {
              <span class="string_special_key string">&quot;const&quot;</span>: <span class="string">&quot;@angular-devkit/build-angular:ssr-dev-server&quot;</span>
            },
            <span class="string_special_key string">&quot;defaultConfiguration&quot;</span>: {
              <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,
              <span class="string_special_key string">&quot;description&quot;</span>: <span class="string">&quot;A default named configuration to use when a target configuration is not provided.&quot;</span>
            },
            <span class="string_special_key string">&quot;options&quot;</span>: {
              <span class="string_special_key string">&quot;$ref&quot;</span>: <span class="string">&quot;../../../../angular_devkit/build_angular/src/builders/ssr-dev-server/schema.json&quot;</span>
            },
            <span class="string_special_key string">&quot;configurations&quot;</span>: {
              <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,
              <span class="string_special_key string">&quot;additionalProperties&quot;</span>: {
                <span class="string_special_key string">&quot;$ref&quot;</span>: <span class="string">&quot;../../../../angular_devkit/build_angular/src/builders/ssr-dev-server/schema.json&quot;</span>
              }
            }
          }
        },
        {
          <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,
          <span class="string_special_key string">&quot;additionalProperties&quot;</span>: <span class="constant_builtin">false</span>,
          <span class="string_special_key string">&quot;properties&quot;</span>: {
            <span class="string_special_key string">&quot;builder&quot;</span>: {
              <span class="string_special_key string">&quot;const&quot;</span>: <span class="string">&quot;@angular-devkit/build-angular:server&quot;</span>
            },
            <span class="string_special_key string">&quot;defaultConfiguration&quot;</span>: {
              <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,
              <span class="string_special_key string">&quot;description&quot;</span>: <span class="string">&quot;A default named configuration to use when a target configuration is not provided.&quot;</span>
            },
            <span class="string_special_key string">&quot;options&quot;</span>: {
              <span class="string_special_key string">&quot;$ref&quot;</span>: <span class="string">&quot;../../../../angular_devkit/build_angular/src/builders/server/schema.json&quot;</span>
            },
            <span class="string_special_key string">&quot;configurations&quot;</span>: {
              <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,
              <span class="string_special_key string">&quot;additionalProperties&quot;</span>: {
                <span class="string_special_key string">&quot;$ref&quot;</span>: <span class="string">&quot;../../../../angular_devkit/build_angular/src/builders/server/schema.json&quot;</span>
              }
            }
          }
        },
        {
          <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,
          <span class="string_special_key string">&quot;additionalProperties&quot;</span>: <span class="constant_builtin">false</span>,
          <span class="string_special_key string">&quot;properties&quot;</span>: {
            <span class="string_special_key string">&quot;builder&quot;</span>: {
              <span class="string_special_key string">&quot;const&quot;</span>: <span class="string">&quot;@angular-devkit/build-angular:ng-packagr&quot;</span>
            },
            <span class="string_special_key string">&quot;defaultConfiguration&quot;</span>: {
              <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,
              <span class="string_special_key string">&quot;description&quot;</span>: <span class="string">&quot;A default named configuration to use when a target configuration is not provided.&quot;</span>
            },
            <span class="string_special_key string">&quot;options&quot;</span>: {
              <span class="string_special_key string">&quot;$ref&quot;</span>: <span class="string">&quot;../../../../angular_devkit/build_angular/src/builders/ng-packagr/schema.json&quot;</span>
            },
            <span class="string_special_key string">&quot;configurations&quot;</span>: {
              <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,
              <span class="string_special_key string">&quot;additionalProperties&quot;</span>: {
                <span class="string_special_key string">&quot;$ref&quot;</span>: <span class="string">&quot;../../../../angular_devkit/build_angular/src/builders/ng-packagr/schema.json&quot;</span>
              }
            }
          }
        }
      ]
    }
  }
},</code></pre></p><p><strong>Where JSON Schema tries to describe any possible JSON data layout, Ziggy Schema is by design only able to describe precisely only a well-defined subset of combinations.</strong></p><p>This is true not just of the schema language but also of some Ziggy Document notation. For example Ziggy has structs and dicts, but no notation for a key-value mapping where <em>some</em> keys are fixed, while <em>some others</em> are up to the user. It should go without saying that JSON schema <a href="https://json-schema.org/understanding-json-schema/reference/object#additionalproperties" target="_blank">does indeed allow to model that as well</a>.</p><h3>Unions all the way down</h3><p>The problem of schema expressivity is at its core a problem about expressing unions.</p><p>A schema is a way of saying that a value can be either <code>A</code> or <code>B</code>, where both could be a a variety of things: different values (e.g. strings that belong to a list or that match a pattern), different types, structs with a given set of fields, etc.</p><p>The more nuanced you want your <em>unions</em> to be, the more syntax and complexity you will need to pull in.</p><p><strong>One key consideration about this problem is that many data layouts are functionally equivalent, and that guiding data layout designers towards well-understood patterns can not only help reduce the complexity of the schema language, but also of data layouts found in the wild.</strong></p><h3>Unions in Ziggy Schema</h3><p>Consider the two following Ziggy documents which are meant to model when an application should refresh itself. In the first example we are giving to <code>refresh</code> a numeric value, indicating how many seconds should pass before a new refresh happens, while in the second case were passing a string that represents a logic condition that must be true to trigger a refresh.</p><pre><code class="ziggy">.<span class="keyword">refresh</span> = <span class="constant_numeric">10</span>
</code></pre>
<pre><code class="ziggy">.<span class="keyword">refresh</span> = <span class="string">&quot;foo.bar &amp;&amp; bar.baz&quot;</span>
</code></pre>
<p>This kind of data layout is fairly common in JSON, where a field can hold different types each with a different meaning.</p><p>In Ziggy this data layout is not idiomatic and in fact Ziggy Schema can only model this <em>union</em> with <code>any</code>:</p><pre><code class="ziggy-schema"><span class="error">$</span> = <span class="type">App</span>

<span class="keyword">struct</span> <span class="type">App</span> <span class="punctuation_bracket">{</span>
  <span class="type">refresh</span>: <span class="keyword">any</span><span class="punctuation_delimiter">,</span>
<span class="punctuation_bracket">}</span>
</code></pre>
<p>Lets fix the previous example using a tagged union:</p><pre><code class="ziggy"><span class="error">.refresh = .interval</span><span class="error punctuation_bracket">(</span><span class="error">10</span><span class="error punctuation_bracket">)</span><span class="error punctuation_delimiter">,</span>
</code></pre>
<pre><code class="ziggy">.<span class="keyword">refresh</span> = <span class="error">.condition</span><span class="error punctuation_bracket">(</span><span class="string">&quot;foo.bar &amp;&amp; bar.baz&quot;</span><span class="error punctuation_bracket">)</span><span class="punctuation_delimiter">,</span>
</code></pre>
<p>This is now the corresponding schema (much better):</p><pre><code class="ziggy-schema"><span class="error">$</span> = <span class="type">App</span>

<span class="keyword">struct</span> <span class="type">App</span> <span class="punctuation_bracket">{</span>
  <span class="type">refresh</span>: <span class="type">Refresh</span><span class="punctuation_delimiter">,</span>

  <span class="type">union</span> <span class="type">Refresh</span> <span class="punctuation_bracket">{</span>
    /// Interval between refreshes, in seconds
    <span class="type">interval</span>: <span class="constant_builtin">int</span><span class="punctuation_delimiter">,</span>
    ///A logical condition that triggers a new  
    ///refresh whenever it evaluates to true.
    <span class="type">condition</span>: <span class="constant_builtin">bytes</span><span class="punctuation_delimiter">,</span>
  <span class="punctuation_bracket">}</span>
<span class="punctuation_bracket">}</span>
</code></pre>
<h2>Parser-friendly Unions</h2><p>Tagged unions are not only good for humans, but machines as well.</p><p>Consider this JSON document where we list some dependencies:</p><pre><code class="json">{
  <span class="string_special_key string">&quot;dependencies&quot;</span>: {
    <span class="string_special_key string">&quot;foo&quot;</span>: {
      <span class="string_special_key string">&quot;url&quot;</span>: <span class="string">&quot;http://...&quot;</span>,
      <span class="string_special_key string">&quot;hash&quot;</span>: <span class="string">&quot;...&quot;</span>
    },
    <span class="string_special_key string">&quot;bar&quot;</span>: {
      <span class="string_special_key string">&quot;path&quot;</span>: <span class="string">&quot;/home/kristoff/ziggy&quot;</span>
    }
  }
}
</code></pre>
<p>Astute observers will notice that dependencies in this data layout can be of two kinds:</p><ul><li>remote, defined by a url and a hash value</li><li>local, defined by a path</li></ul><p>Unfortunately this data layout is hostile to parsing.</p><p>Using Zig lingo as an example, you would like to be able to parse this document into the following kind of type:</p><pre><code class="zig"><span class="keyword">const</span> <span class="constant variable_builtin type variable">Dependency</span> <span class="operator">=</span> <span class="keyword_type">union</span><span class="punctuation_bracket">(</span><span class="keyword_type">enum</span><span class="punctuation_bracket">)</span> <span class="punctuation_bracket">{</span>
  <span class="constant variable_builtin type variable_member variable">remote</span><span class="punctuation_delimiter">:</span> <span class="keyword_type">struct</span> <span class="punctuation_bracket">{</span>
    <span class="constant variable_builtin type variable_member variable">url</span><span class="punctuation_delimiter">:</span> <span class="punctuation_bracket">[</span><span class="punctuation_bracket">]</span><span class="keyword">const</span> <span class="type_builtin">u8</span><span class="punctuation_delimiter">,</span>
    <span class="constant variable_builtin type variable_member variable">hash</span><span class="punctuation_delimiter">:</span> <span class="punctuation_bracket">[</span><span class="punctuation_bracket">]</span><span class="keyword">const</span> <span class="type_builtin">u8</span><span class="punctuation_delimiter">,</span>
  <span class="punctuation_bracket">}</span><span class="punctuation_delimiter">,</span>
  <span class="constant variable_builtin type variable_member variable">local</span><span class="punctuation_delimiter">:</span> <span class="keyword_type">struct</span> <span class="punctuation_bracket">{</span>
    <span class="constant variable_builtin type variable_member variable">path</span><span class="punctuation_delimiter">:</span> <span class="punctuation_bracket">[</span><span class="punctuation_bracket">]</span><span class="keyword">const</span> <span class="type_builtin">u8</span><span class="punctuation_delimiter">,</span>
  <span class="punctuation_bracket">}</span><span class="punctuation_delimiter">,</span>
<span class="punctuation_bracket">}</span><span class="punctuation_delimiter">;</span>
</code></pre>
<p>Unfortunately this wont work with type-driven parsers as those will need to know which union case they are in <em>before</em> parsing the value of each dependency.</p><p>In this specific case the parser could notice that if the first field it finds is <code>path</code>, then its the <code>local</code> case, but different cases could share some fields making a general solution to this problem more problematic than what it needs to be, which in practice it means that you cant rely on parsers supporting this feature.</p><p>Some JSON data layouts make use of a <code>type</code> field to help disambiguate:</p><pre><code class="json">{
  <span class="string_special_key string">&quot;dependencies&quot;</span>: {
    <span class="string_special_key string">&quot;foo&quot;</span>: {
      <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;remote&quot;</span>,
      <span class="string_special_key string">&quot;url&quot;</span>: <span class="string">&quot;http://...&quot;</span>,
      <span class="string_special_key string">&quot;hash&quot;</span>: <span class="string">&quot;...&quot;</span>
    },
    <span class="string_special_key string">&quot;bar&quot;</span>: {
      <span class="string_special_key string">&quot;type&quot;</span>: <span class="string">&quot;local&quot;</span>,
      <span class="string_special_key string">&quot;path&quot;</span>: <span class="string">&quot;/home/kristoff/ziggy&quot;</span>
    }
  }
}
</code></pre>
<p>Unfortunately this approach doesnt solve the problem fully either because field order is not meaningful in JSON and so the parser cant be guaranteed that <code>type</code> will be the first field it sees.</p><p>It should be noted at this point that the problem only partially has to do with the rigidity of statically typed languages. A language like JavaScript wont be affected by this problem because it will parse data into a dynamic object anyway, but statically typed languages can leverage type information to get dramatic performance improvements.</p><p>This means that statically typed, compiled languages could make this work by going through a dynamic value parsing phase, but the whole point of using a language of that kind is to aim for optimal behavior, which is made unreasonably harder by the lack of a tagged union construct in JSON.</p><p>The sad result is that too often people recur to creating <em>sausage</em> types, where every possible combination of fields is minced into a single struct type filled with optionals:</p><pre><code class="zig"><span class="keyword">const</span> <span class="constant variable_builtin type variable">Dependency</span> <span class="operator">=</span> <span class="keyword_type">struct</span> <span class="punctuation_bracket">{</span>
  <span class="constant variable_builtin type variable_member variable">url</span><span class="punctuation_delimiter">:</span> <span class="operator">?</span><span class="punctuation_bracket">[</span><span class="punctuation_bracket">]</span><span class="keyword">const</span> <span class="type_builtin">u8</span><span class="punctuation_delimiter">,</span>
  <span class="constant variable_builtin type variable_member variable">hash</span><span class="punctuation_delimiter">:</span> <span class="operator">?</span><span class="punctuation_bracket">[</span><span class="punctuation_bracket">]</span><span class="keyword">const</span> <span class="type_builtin">u8</span><span class="punctuation_delimiter">,</span>
  <span class="constant variable_builtin type variable_member variable">path</span><span class="punctuation_delimiter">:</span> <span class="operator">?</span><span class="punctuation_bracket">[</span><span class="punctuation_bracket">]</span><span class="keyword">const</span> <span class="type_builtin">u8</span><span class="punctuation_delimiter">,</span>
<span class="punctuation_bracket">}</span><span class="punctuation_delimiter">;</span>
</code></pre>
<p>Ziggy unions use struct names to indicate the active union case, turning the previous example into the following document:</p><pre><code class="ziggy">.<span class="keyword">dependencies</span> = <span class="punctuation_bracket">{</span>
  <span class="string">&quot;foo&quot;</span>: <span class="error">.remote</span><span class="error punctuation_bracket">(</span><span class="error">.</span><span class="punctuation_bracket">{</span>
    .<span class="keyword">url</span> = <span class="string">&quot;http://...&quot;</span><span class="punctuation_delimiter">,</span>
    .<span class="keyword">hash</span> = <span class="string">&quot;...&quot;</span>
  <span class="punctuation_bracket">}</span><span class="error punctuation_bracket">)</span><span class="punctuation_delimiter">,</span>
  <span class="string">&quot;bar&quot;</span>: <span class="error">.local</span><span class="error punctuation_bracket">(</span><span class="error">.</span><span class="punctuation_bracket">{</span>
    .<span class="keyword">path</span> = <span class="string">&quot;/home/kristoff/ziggy&quot;</span><span class="punctuation_delimiter">,</span>
  <span class="punctuation_bracket">}</span><span class="error punctuation_bracket">)</span><span class="punctuation_delimiter">,</span>
<span class="punctuation_bracket">}</span><span class="punctuation_delimiter">,</span>
</code></pre>
<p>This has two big advantages:</p><ul><li>guarantees that parsers see the union case before the value</li><li>helps the LSP provide relevant diagnostics and autocomplete without needing to guess which is the active union case</li></ul><h2>Concrete tips</h2><ul><li><p>When a key-value map has some fixed and some user-defined fields, push the latter kind of fields into a nested dict value.</p><pre><code class="ziggy">.<span class="keyword">title</span> = <span class="string">&quot;foo&quot;</span><span class="punctuation_delimiter">,</span>
.<span class="keyword">date</span> = <span class="error">.iso</span><span class="error punctuation_bracket">(</span><span class="string">&quot;2024-01-01&quot;</span><span class="error punctuation_bracket">)</span><span class="punctuation_delimiter">,</span>
.<span class="keyword">draft</span> = <span class="constant_builtin_boolean">false</span><span class="punctuation_delimiter">,</span>
.<span class="keyword">custom</span> = <span class="punctuation_bracket">{</span>
  <span class="string">&quot;put&quot;</span>: <span class="string">&quot;here&quot;</span><span class="punctuation_delimiter">,</span>
  <span class="string">&quot;custom&quot;</span>: <span class="string">&quot;fields&quot;</span><span class="punctuation_delimiter">,</span>
<span class="punctuation_bracket">}</span><span class="punctuation_delimiter">,</span>
</code></pre>
</li><li><p>Ziggy Documents are more powerful than Ziggy Schema. For example this is a perfectly valid Ziggy document that cant be described precisely by a Ziggy Schema:</p><pre><code class="ziggy"><span class="punctuation_bracket">[</span><span class="string">&quot;hello&quot;</span><span class="punctuation_delimiter">,</span> <span class="constant_builtin_boolean">true</span><span class="punctuation_delimiter">,</span> <span class="constant_numeric">42</span><span class="punctuation_bracket">]</span>
</code></pre>
</li></ul><p>If youre reading and writing Ziggy Documents within a single application where you dont have external consumers that would benefit from a Ziggy Schema, feel free to adopt any arbitrary layout that works for you.</p></div>
			<nav id="footer">
				<div>
					<a href="/documentation/schema-structure/">
						<p>
							
							<span class="title">Schema Structure</span>
						</p>
					</a>
				</div>
				<div>
					<a href="/documentation/parsers/">
						<p>
							<span class="title">Parsers</span>
							
						</p>
					</a>
				</div>
			</nav>
		</div>
	</div>

	</body>
</html>
